<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Agentic RAG Creator</title>
  <style>
    *{margin:0;padding:0;box-sizing:border-box}
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu;
      background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);
      min-height:100vh;display:flex;justify-content:center;align-items:center;padding:20px}
    .container{background:#fff;border-radius:16px;box-shadow:0 20px 60px rgba(0,0,0,.3);
      max-width:720px;width:100%;padding:32px}
    .header{text-align:center;margin-bottom:16px}
    .header h1{font-size:28px;color:#1f2937}
    .header p{color:#6b7280}
    .top-link{ text-align:center;margin:8px 0 16px }
    .top-link a{ color:#fff; text-decoration:underline }
    .form-group{margin:16px 0}
    label{display:block;color:#111827;font-weight:600;margin-bottom:8px;font-size:14px}
    input[type=text], textarea{
      width:100%;padding:12px 14px;border:2px solid #e5e7eb;border-radius:10px;font-size:16px}
    input[type=text]:focus, textarea:focus{
      outline:none;border-color:#6366f1;box-shadow:0 0 0 3px rgba(99,102,241,.1)}
    .file-input-wrapper{position:relative;border:2px dashed #cbd5e0;border-radius:10px;
      padding:24px;text-align:center;background:#f9fafb;cursor:pointer}
    .file-input-wrapper:hover{border-color:#6366f1;background:#eef2ff}
    input[type=file]{position:absolute;width:100%;height:100%;top:0;left:0;opacity:0;cursor:pointer}
    .file-list{display:none;margin-top:12px;background:#f9fafb;padding:10px;border-radius:8px}
    .file-list.show{display:block}
    .file-item{display:flex;justify-content:space-between;align-items:center;
      padding:8px 10px;background:#fff;border-radius:8px;margin-bottom:8px}
    .remove-file{color:#ef4444;font-weight:700;cursor:pointer;margin-left:8px}
    .create-btn{width:100%;padding:14px;border:none;border-radius:10px;color:#fff;
      background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);
      font-weight:700;cursor:pointer;box-shadow:0 8px 20px rgba(99,102,241,.35)}
    .error{margin-top:8px;color:#b91c1c}
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>ü§ñ Agentic RAG Creator</h1>
      <p>Build intelligent knowledge retrieval systems with ease</p>
    </div>

    <p class="top-link">
        <a href="/rags/" style="
           display:inline-block;
           padding:10px 14px;
           border-radius:10px;
           background:#4f46e5;
           color:#fff;
           text-decoration:none;
           font-weight:700;
           box-shadow:0 6px 14px rgba(79,70,229,.3);
        ">
          Browse my RAGs ‚Üí
        </a>
      </p>

    <form id="ragForm" method="post" enctype="multipart/form-data">
      {% csrf_token %}
      <div class="form-group">
        <label for="ragName">RAG System Name *</label>
        <input id="ragName" name="ragName" type="text" placeholder="e.g., Customer Support Knowledge Base" required />
      </div>

      <div class="form-group">
        <label for="ragDescription">RAG Description</label>
        <textarea id="ragDescription" name="ragDescription" rows="3"
          placeholder="Provide a high-level description of your RAG's purpose and scope..."></textarea>
      </div>

      <div class="form-group">
        <label>Upload Knowledge Base Files *</label>
        <div class="file-input-wrapper" id="fileWrapper">
          <input id="files" name="files" type="file" multiple accept=".pdf,.txt,.docx,.md,.markdown" />
          <div style="font-size:42px;margin-bottom:6px">üìÅ</div>
          <div style="color:#374151">
            <strong>Click to upload</strong> or drag and drop<br/>
            <small>PDF, TXT, DOCX, MD files supported</small>
          </div>
        </div>
        <div id="fileList" class="file-list"></div>
      </div>

      {% if error %}
        <div class="error">{{ error }}</div>
      {% endif %}

      <button id="createBtn" class="create-btn" type="submit">Create Agentic RAG</button>
    </form>
  </div>

  <script>
    let selectedFiles = [];
    const fileInput = document.getElementById('files');
    const fileWrapper = document.getElementById('fileWrapper');
    const fileList = document.getElementById('fileList');
    const form = document.getElementById('ragForm');

    fileInput.addEventListener('change', e => handleFiles(e.target.files));
    fileWrapper.addEventListener('dragover', e => { e.preventDefault(); fileWrapper.classList.add('dragover'); });
    fileWrapper.addEventListener('dragleave', e => { e.preventDefault(); fileWrapper.classList.remove('dragover'); });
    fileWrapper.addEventListener('drop', e => {
      e.preventDefault(); fileWrapper.classList.remove('dragover'); handleFiles(e.dataTransfer.files);
    });

    function handleFiles(files) { selectedFiles = Array.from(files); displayFiles(); }

    function displayFiles() {
      if (!selectedFiles.length) return fileList.classList.remove('show');
      fileList.classList.add('show');
      fileList.innerHTML = selectedFiles.map((f, i) =>
        `<div class="file-item"><span>${f.name}</span><span class="remove-file" onclick="removeFile(${i})">‚úï</span></div>`
      ).join('');
    }

    function removeFile(i) {
      selectedFiles.splice(i, 1);
      const dt = new DataTransfer();
      selectedFiles.forEach(f => dt.items.add(f));
      fileInput.files = dt.files;
      displayFiles();
    }

    form.addEventListener('submit', e => {
      const name = document.getElementById('ragName').value.trim();
      if (!name) { e.preventDefault(); alert('Please enter a RAG system name'); return; }
      if (!fileInput.files.length) { e.preventDefault(); alert('Please upload at least one file'); return; }
    });
  </script>
</body>
</html>